var PhotoSphereViewer=function(e){var t=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},n=function(){var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl"))},o=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},i=function(e,t,n){return Math.max(t,Math.min(n,e))},r=function(e,t,n,o){var i=n-e,r=o-t;return i*i+r*r},a=function(e,t){return t=void 0!==t?!!t:!1,t&&e==2*Math.PI?2*Math.PI:e-2*Math.floor(e/(2*Math.PI))*Math.PI};this.load=function(){if(ft.innerHTML="",Wt&&1===Wt.nodeType)ft.appendChild(Wt);else if(Wt&&"string"==typeof Wt)ft.innerHTML=Wt;else if(Xt){var e=document.createElement("img");e.setAttribute("src",Xt),e.setAttribute("alt",Dt),ft.appendChild(e)}else ft.textContent=Dt;return wt=document.createElement("div"),wt.style.width="100%",wt.style.height="100%",wt.style.position="relative",wt.style.overflow="hidden",t()?void 0===window.THREE?void console.log("PhotoSphereViewer: Three.js is not loaded."):(yt={width:0,height:0,ratio:0},void(At&&!kt.match(/^data:image\/[a-z]+;base64/)?l():d())):void(ft.textContent="Canvas is not supported, update your browser!")};var s=function(e,t){var n=e.indexOf("GPano:"+t)+t.length+8,o=e.indexOf('"',n);return e.substring(n,o)},l=function(){var e=null;if(window.XMLHttpRequest)e=new XMLHttpRequest;else{if(!window.ActiveXObject)return void(ft.textContent="XHR is not supported, update your browser!");try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){e=new ActiveXObject("Microsoft.XMLHTTP")}}e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var t=e.responseText,n=t.indexOf("<x:xmpmeta"),o=t.indexOf("</x:xmpmeta>"),i=t.substring(n,o);if(-1==n||-1==o||-1==i.indexOf("GPano:"))return void d(!1);Lt={full_width:parseInt(s(i,"FullPanoWidthPixels")),full_height:parseInt(s(i,"FullPanoHeightPixels")),cropped_width:parseInt(s(i,"CroppedAreaImageWidthPixels")),cropped_height:parseInt(s(i,"CroppedAreaImageHeightPixels")),cropped_x:parseInt(s(i,"CroppedAreaLeftPixels")),cropped_y:parseInt(s(i,"CroppedAreaTopPixels"))},d()}},e.open("GET",kt,!0),e.send(null)},d=function(){var t=new Image;t.onload=function(){var e={full_width:t.width,full_height:t.height,cropped_width:t.width,cropped_height:t.height,cropped_x:null,cropped_y:null};for(attr in Lt)null==Lt[attr]&&void 0!==e[attr]&&(Lt[attr]=e[attr]);null==Lt.cropped_x&&(Lt.cropped_x=(Lt.full_width-Lt.cropped_width)/2),null==Lt.cropped_y&&(Lt.cropped_y=(Lt.full_height-Lt.cropped_height)/2);var o=2048;if(n()){var i=document.createElement("canvas"),r=i.getContext("webgl");o=r.getParameter(r.MAX_TEXTURE_SIZE)}var a=Math.min(Lt.full_width,o),s=a/Lt.full_width;Lt.full_width=a,Lt.cropped_width*=s,Lt.cropped_x*=s,t.width=Lt.cropped_width,Lt.full_height*=s,Lt.cropped_height*=s,Lt.cropped_y*=s,t.height=Lt.cropped_height;var l=document.createElement("canvas");l.width=Lt.full_width,l.height=Lt.full_height;var r=l.getContext("2d");r.drawImage(t,Lt.cropped_x,Lt.cropped_y,Lt.cropped_width,Lt.cropped_height),c(l.toDataURL("image/jpeg"))},e.cors_anonymous&&(kt.match(/^data:image\/[a-z]+;base64/)||t.setAttribute("crossOrigin","anonymous")),t.src=kt},c=function(e){var t=new THREE.Texture,n=new THREE.ImageLoader,o=function(e){t.needsUpdate=!0,t.image=e,u(t)};n.load(e,o)},u=function(e){void 0!==bt.width&&(ft.style.width=bt.width.css),void 0!==bt.height&&(ft.style.height=bt.height.css),b(),_t=n()?new THREE.WebGLRenderer:new THREE.CanvasRenderer,_t.setSize(yt.width,yt.height),Et=new THREE.Scene,St=new THREE.PerspectiveCamera(Y,yt.ratio,1,300),St.position.set(0,0,0),Et.add(St);var t=new THREE.SphereGeometry(200,32,32),i=new THREE.MeshBasicMaterial({map:e,overdraw:!0}),r=new THREE.Mesh(t,i);r.scale.x=-1,Et.add(r),Ct=document.createElement("div"),Ct.style.position="absolute",Ct.style.zIndex=0,wt.appendChild(Ct),gt&&(pt.setStyle(mt),pt.create(),wt.appendChild(pt.getBar())),o(window,"resize",b),vt&&(o(Ct,"mousedown",C),o(document,"mousemove",z),o(Ct,"mousemove",D),o(document,"mouseup",S),o(Ct,"touchstart",k),o(document,"touchend",S),o(document,"touchmove",T),o(Ct,"mousewheel",H),o(Ct,"DOMMouseScroll",H)),o(document,"fullscreenchange",O),o(document,"mozfullscreenchange",O),o(document,"webkitfullscreenchange",O),o(document,"MSFullscreenChange",O),Bt.addListener(P),ft.innerHTML="",ft.appendChild(wt);var a=_t.domElement;a.style.display="block",Ct.appendChild(a),h(),it>0&&F(it),m(),$("ready")},h=function(){var e=new THREE.Vector3;e.setX(Math.cos(tt)*Math.sin(nt)),e.setY(Math.sin(tt)),e.setZ(Math.cos(tt)*Math.cos(nt)),St.lookAt(e),null!==zt?zt.render(Et,St):_t.render(Et,St)},p=function(){zt=new THREE.StereoEffect(_t),zt.eyeSeparation=5,zt.setSize(yt.width,yt.height),I(),A(),pt.mustBeHidden(),h(),$("stereo-effect",!0)},g=function(){zt=null,_t.setSize(yt.width,yt.height),pt.mustBeHidden(!1),h(),$("stereo-effect",!1)};this.toggleStereo=function(){null!==zt?g():p()};var m=function(){st!==!1&&(Ft=setTimeout(y,st))},v=function(){tt-=(tt-ut)*ct,nt+=lt;var e=!0;J||(nt=i(nt,Q,et),(nt==Q||nt==et)&&(dt?lt*=-1:(f(),e=!1))),nt=a(nt,!0),h(),e&&(Ht=setTimeout(v,at))},y=function(){v(),$("autorotate",!0)},f=function(){clearTimeout(Ft),Ft=null,clearTimeout(Ht),Ht=null,$("autorotate",!1)};this.toggleAutorotate=function(){clearTimeout(Ft),Ht?f():y()};var b=function(){(ft.clientWidth!=yt.width||ft.clientHeight!=yt.height)&&x({width:ft.clientWidth,height:ft.clientHeight})};this.fitToContainer=function(){b()};var x=function(e){yt.width=void 0!==e.width?parseInt(e.width):yt.width,yt.height=void 0!==e.height?parseInt(e.height):yt.height,yt.ratio=yt.width/yt.height,St&&(St.aspect=yt.ratio,St.updateProjectionMatrix()),_t&&(_t.setSize(yt.width,yt.height),h()),zt&&(zt.setSize(yt.width,yt.height),h())};this.getPosition=function(){return{longitude:nt,latitude:tt}},this.getPositionInDegrees=function(){return{longitude:180*nt/Math.PI,latitude:180*tt/Math.PI}};var w=function(e,t){var n=W(e);J||(n=i(n,Q,et));var o=W(t);o>Math.PI&&(o-=2*Math.PI),o=i(o,U,j),nt=n,tt=o,h()};this.moveTo=function(e,t){w(e,t)};var C=function(e){_(parseInt(e.clientX),parseInt(e.clientY))},k=function(e){if(1==e.touches.length){var t=e.touches[0];t.target.parentNode==Ct&&_(parseInt(t.clientX),parseInt(t.clientY))}else 2==e.touches.length&&(S(),e.touches[0].target.parentNode==Ct&&e.touches[1].target.parentNode==Ct&&E(r(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY)));D()},_=function(e,t){Rt=e,It=t,f(),Tt=!0},E=function(e){Pt=e,Mt=!0},S=function(){Tt=!1,Mt=!1},z=function(e){e.preventDefault(),R(parseInt(e.clientX),parseInt(e.clientY))},T=function(e){if(1==e.touches.length&&Tt){var t=e.touches[0];t.target.parentNode==Ct&&(e.preventDefault(),R(parseInt(t.clientX),parseInt(t.clientY)))}else if(2==e.touches.length&&e.touches[0].target.parentNode==Ct&&e.touches[1].target.parentNode==Ct&&Mt){e.preventDefault();var n=r(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY),o=n-Pt;if(0!=o){var i=o/Math.abs(o);F(it+i),Pt=n}}},R=function(e,t){Tt&&(nt+=(e-Rt)*q,J||(nt=i(nt,Q,et)),nt=a(nt,!0),tt+=(t-It)*V,tt=i(tt,U,j),Rt=e,It=t,h())},I=function(){Bt.start(),f(),$("device-orientation",!0)},M=function(){Bt.stop(),$("device-orientation",!1)};this.toggleDeviceOrientation=function(){Bt.isEventAttached()?M():I()};var P=function(e){nt=i(e.longitude,Q,et),tt=i(e.latitude,U,j),h()},H=function(e){e.preventDefault(),e.stopPropagation();var t=e.detail?-e.detail:e.wheelDelta;if(0!=t){var n=parseInt(t/Math.abs(t));F(it+n)}},F=function(e){it=i(parseInt(Math.round(e)),0,100),St.fov=Y+it/100*(G-Y),St.updateProjectionMatrix(),h(),$("zoom-updated",it)};this.zoom=function(e){F(e)},this.zoomIn=function(){100>it&&F(it+1)},this.zoomOut=function(){it>0&&F(it-1)};var B=function(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},O=function(){document.webkitFullscreenElement||document.msFullscreenElement?(xt.width=ft.style.width,xt.height=ft.style.height,ft.style.width="100%",ft.style.height="100%",b()):(ft.webkitRequestFullscreen||ft.msRequestFullscreen)&&(ft.style.width=xt.width,ft.style.height=xt.height,b()),$("fullscreen-mode",B())},A=function(){ft.requestFullscreen?ft.requestFullscreen():ft.mozRequestFullScreen?ft.mozRequestFullScreen():ft.webkitRequestFullscreen?ft.webkitRequestFullscreen():ft.msRequestFullscreen&&ft.msRequestFullscreen()},L=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()};this.toggleFullscreen=function(){B()?L():A()};var D=function(){gt&&pt.show()},X=function(e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),n=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();n.match(/(pm|per minute)$/)&&(t/=60);var o=0;switch(n){case"rpm":case"rev per minute":case"revolutions per minute":case"rps":case"rev per second":case"revolutions per second":o=2*t*Math.PI;break;case"dpm":case"deg per minute":case"degrees per minute":case"dps":case"deg per second":case"degrees per second":o=t*Math.PI/180;break;case"rad per minute":case"radians per minute":case"rad per second":case"radians per second":o=t;break;default:m_anim=!1}return o*at/1e3},W=function(e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),n=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();return"deg"==n&&(t*=Math.PI/180),a(t)},N=function(e){for(dim in e)if("width"==dim||"height"==dim){var t=e[dim].toString().trim(),n=parseFloat(t.replace(/^([0-9]+(?:\.[0-9]*)?).*$/,"$1")),o=t.replace(/^[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();"%"!=o&&(o="px"),bt[dim]={css:n+o,unit:o}}};this.addAction=function(e,t){e in Ot||(Ot[e]=[]),Ot[e].push(t)};var $=function(e,t){if(e in Ot&&Ot[e].length)for(var n=0,o=Ot[e].length;o>n;++n)void 0!==t?Ot[e][n](t):Ot[e][n]()};if(void 0===e||void 0===e.panorama||void 0===e.container)return void console.log("PhotoSphereViewer: no value given for panorama or container");var q=void 0!==e.long_offset?parseFloat(e.long_offset):Math.PI/360,V=void 0!==e.lat_offset?parseFloat(e.lat_offset):Math.PI/180,G=void 0!==e.min_fov?i(parseFloat(e.min_fov),1,179):30,Y=void 0!==e.max_fov?i(parseFloat(e.max_fov),1,179):90,j=void 0!==e.tilt_up_max?i(W(e.tilt_up_max),0,Math.PI/2):Math.PI/2,U=void 0!==e.tilt_down_max?-i(W(e.tilt_down_max),0,Math.PI/2):-Math.PI/2,K=void 0!==e.min_longitude?W(e.min_longitude):0,Z=void 0!==e.max_longitude?W(e.max_longitude):0,J=K==Z;J?(K=0,Z=2*Math.PI):0==Z&&(Z=2*Math.PI);var Q,et;Z>K?(Q=K,et=Z):(Q=Z,et=K);var tt=0,nt=Q;if(void 0!==e.default_position){if(void 0!==e.default_position.lat){var ot=W(e.default_position.lat);ot>Math.PI&&(ot-=2*Math.PI),tt=i(ot,U,j)}void 0!==e.default_position["long"]&&(nt=i(W(e.default_position["long"]),Q,et))}var it=0;void 0!==e.zoom_level&&(it=i(parseInt(Math.round(e.zoom_level)),0,100));var rt=60,at=1e3/rt,st=2e3;void 0!==e.time_anim&&(st="number"==typeof e.time_anim&&e.time_anim>=0?e.time_anim:!1);var lt=X(void 0!==e.anim_speed?e.anim_speed:"2rpm"),dt=!0;void 0!==e.reverse_anim&&(dt=!!e.reverse_anim);var ct=X(void 0!==e.vertical_anim_speed?e.vertical_anim_speed:"2rpm"),ut=0;if(void 0!==e.vertical_anim_target){var ht=W(e.vertical_anim_target);ht>Math.PI&&(ht-=2*Math.PI),ut=i(ht,U,j)}var pt=new PSVNavBar(this),gt=void 0!==e.navbar?!!e.navbar:!1,mt=void 0!==e.navbar_style?e.navbar_style:{},vt=void 0!==e.allow_user_interactions?!!e.allow_user_interactions:!0;vt||(gt=!1);var yt,ft=e.container,bt={},xt={};void 0!==e.size&&N(e.size);var wt,Ct,kt=e.panorama,_t=null,Et=null,St=null,zt=null,Tt=!1,Rt=0,It=0,Mt=!1,Pt=0,Ht=null,Ft=null,Bt=new Sphoords,Ot={},At=void 0!==e.usexmpdata?!!e.usexmpdata:!0,Lt={full_width:null,full_height:null,cropped_width:null,cropped_height:null,cropped_x:null,cropped_y:null};if(void 0!==e.pano_size){for(attr in Lt)void 0!==e.pano_size[attr]&&(Lt[attr]=parseInt(e.pano_size[attr]));At=!1}var Dt=void 0!==e.loading_msg?e.loading_msg.toString():"Loading…",Xt=void 0!==e.loading_img?e.loading_img.toString():null,Wt=void 0!==e.loading_html?e.loading_html:null;void 0!==e.onready&&this.addAction("ready",e.onready);var Nt=void 0!==e.autoload?!!e.autoload:!0;Nt&&this.load()},PSVNavBar=function(e){var t=function(e,t){for(var n=0,o=t.length;o>n;++n)if(t[n]==e)return!0;return!1},n=function(e,n){return t(e,h)&&"string"==typeof n&&("transparent"==n||!!n.match(/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/)||!!n.match(/^rgb\((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])(,\s*(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}\)$/)||!!n.match(/^rgba\(((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),\s*){3}(0(\.[0-9]*)?|1)\)$/))||t(e,p)&&!isNaN(parseFloat(n))&&isFinite(n)&&n>=0};this.setStyle=function(e){for(property in e)property in u&&n(property,e[property])&&(u[property]=e[property])},this.create=function(){r=document.createElement("div"),r.style.backgroundColor=u.backgroundColor,r.style.position="absolute",r.style.zIndex=10,r.style.bottom=0,r.style.width="100%",r.style.boxSizing="content-box",r.style.transition="bottom 0.4s ease-out",a=new PSVNavBarButton(e,"autorotate",u),r.appendChild(a.getButton()),s=new PSVNavBarButton(e,"zoom",u),r.appendChild(s.getButton()),l=new PSVNavBarButton(e,"fullscreen",u),r.appendChild(l.getButton()),Sphoords.isDeviceOrientationSupported&&(d=new PSVNavBarButton(e,"orientation",u),r.appendChild(d.getButton()),c=new PSVNavBarButton(e,"virtual-reality",u),r.appendChild(c.getButton()))},this.getBar=function(){return r};var o=function(){g&&(clearTimeout(g),!m&&v&&(g=setTimeout(i,5e3))),m&&(r.style.bottom=0,m=!1,v&&(g=setTimeout(i,5e3)))};this.show=function(){o()};var i=function(){m||(r.style.bottom=-r.offsetHeight+1+"px",m=!0)};this.hide=function(){i()},this.isHidden=function(){return m},this.mustBeHidden=function(e){v=void 0!==e?!!e:!0,v?i():o()};var r,a,s,l,d,c,u={backgroundColor:"rgba(61, 61, 61, 0.5)",buttonsColor:"rgba(255, 255, 255, 0.7)",buttonsBackgroundColor:"transparent",activeButtonsBackgroundColor:"rgba(255, 255, 255, 0.1)",buttonsHeight:20,autorotateThickness:1,zoomRangeWidth:50,zoomRangeThickness:1,zoomRangeDisk:7,fullscreenRatio:4/3,fullscreenThickness:2,gyroscopeThickness:1,virtualRealityRatio:4/3,virtualRealityBorderRadius:2},h=["backgroundColor","buttonsColor","buttonsBackgroundColor","activeButtonsBackgroundColor"],p=["buttonsHeight","autorotateThickness","zoomRangeWidth","zoomRangeThickness","zoomRangeDisk","fullscreenRatio","fullscreenThickness"],g=null,m=!1,v=!1},PSVNavBarButton=function(e,t,n){var o=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},i=function(){switch(t){case"autorotate":var i=n.buttonsHeight-2*n.autorotateThickness,p=i/10;l=document.createElement("div"),l.style.cssFloat="left",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=n.buttonsHeight+"px",l.style.height=n.buttonsHeight+"px",l.style.backgroundColor=n.buttonsBackgroundColor,l.style.position="relative",l.style.cursor="pointer",o(l,"click",function(){e.toggleAutorotate()});var y=document.createElement("div");y.style.boxSizing="inherit",y.style.width=i+"px",y.style.height=i+"px",y.style.borderRadius="50%",y.style.border=n.autorotateThickness+"px solid "+n.buttonsColor,l.appendChild(y);var f=document.createElement("div");f.style.boxSizing="inherit",f.style.width=i+"px",f.style.height=p+"px",f.style.borderRadius="50%",f.style.border=n.autorotateThickness+"px solid "+n.buttonsColor,f.style.position="absolute",f.style.top="50%",f.style.marginTop=-(p/2+n.autorotateThickness)+"px",l.appendChild(f),e.addAction("autorotate",d);break;case"zoom":l=document.createElement("div"),l.style.cssFloat="left",l.style.boxSizing="inherit";var b=document.createElement("div");b.style.cssFloat="left",b.style.boxSizing="inherit",b.style.padding="10px",b.style.height=n.buttonsHeight+"px",b.style.backgroundColor=n.buttonsBackgroundColor,b.style.lineHeight=n.buttonsHeight+"px",b.style.color=n.buttonsColor,b.style.cursor="pointer",b.textContent="-",o(b,"click",function(){e.zoomOut()}),l.appendChild(b),r=document.createElement("div"),r.style.cssFloat="left",r.style.boxSizing="inherit",r.style.padding=10+(n.buttonsHeight-n.zoomRangeThickness)/2+"px 5px",r.style.backgroundColor=n.buttonsBackgroundColor,r.style.cursor="pointer",l.appendChild(r),a=document.createElement("div"),a.style.boxSizing="inherit",a.style.width=n.zoomRangeWidth+"px",a.style.height=n.zoomRangeThickness+"px",a.style.backgroundColor=n.buttonsColor,a.style.position="relative",r.appendChild(a),s=document.createElement("div"),s.style.position="absolute",s.style.top=(n.zoomRangeThickness-n.zoomRangeDisk)/2+"px",s.style.left=-(n.zoomRangeDisk/2)+"px",s.style.boxSizing="inherit",s.style.width=n.zoomRangeDisk+"px",s.style.height=n.zoomRangeDisk+"px",s.style.borderRadius="50%",s.style.backgroundColor=n.buttonsColor,e.addAction("zoom-updated",c),o(r,"mousedown",u),o(r,"touchstart",h),o(document,"mousemove",m),o(document,"touchmove",v),o(document,"mouseup",g),o(document,"touchend",g),a.appendChild(s);var x=document.createElement("div");x.style.cssFloat="left",x.style.boxSizing="inherit",x.style.padding="10px",x.style.height=n.buttonsHeight+"px",x.style.backgroundColor=n.buttonsBackgroundColor,x.style.lineHeight=n.buttonsHeight+"px",x.style.color=n.buttonsColor,x.style.cursor="pointer",x.textContent="+",o(x,"click",function(){e.zoomIn()}),l.appendChild(x);break;case"fullscreen":var w=n.buttonsHeight*n.fullscreenRatio,C=.3*n.buttonsHeight,k=(n.buttonsHeight-C)/2,_=.3*w,E=(w-_)/2-n.fullscreenThickness,S=n.buttonsHeight-2*n.fullscreenThickness;l=document.createElement("div"),l.style.cssFloat="right",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=w+"px",l.style.height=n.buttonsHeight+"px",l.style.backgroundColor=n.buttonsBackgroundColor,l.style.cursor="pointer",o(l,"click",function(){e.toggleFullscreen()});var z=document.createElement("div");z.style.cssFloat="left",z.style.boxSizing="inherit",z.style.width=n.fullscreenThickness+"px",z.style.height=C+"px",z.style.borderStyle="solid",z.style.borderColor=n.buttonsColor+" transparent",z.style.borderWidth=k+"px 0",l.appendChild(z);var T=document.createElement("div");T.style.cssFloat="left",T.style.boxSizing="inherit",T.style.width=E+"px",T.style.height=S+"px",T.style.borderStyle="solid",T.style.borderColor=n.buttonsColor+" transparent",T.style.borderWidth=n.fullscreenThickness+"px 0",l.appendChild(T);var R=document.createElement("div");R.style.cssFloat="left",R.style.boxSizing="inherit",R.style.marginLeft=_+"px",R.style.width=E+"px",R.style.height=S+"px",R.style.borderStyle="solid",R.style.borderColor=n.buttonsColor+" transparent",R.style.borderWidth=n.fullscreenThickness+"px 0",l.appendChild(R);var I=document.createElement("div");I.style.cssFloat="left",I.style.boxSizing="inherit",I.style.width=n.fullscreenThickness+"px",I.style.height=C+"px",I.style.borderStyle="solid",I.style.borderColor=n.buttonsColor+" transparent",I.style.borderWidth=k+"px 0",l.appendChild(I);var M=document.createElement("div");M.style.clear="left",l.appendChild(M),e.addAction("fullscreen-mode",d);break;case"orientation":var P=n.buttonsHeight-2*n.gyroscopeThickness,H=P-4*n.gyroscopeThickness,F=P/10;l=document.createElement("div"),l.style.cssFloat="right",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=n.buttonsHeight+"px",l.style.height=n.buttonsHeight+"px",l.style.backgroundColor=n.buttonsBackgroundColor,l.style.position="relative",l.style.cursor="pointer",o(l,"click",function(){e.toggleDeviceOrientation()});var B=document.createElement("div");B.style.boxSizing="inherit",B.style.width=P+"px",B.style.height=P+"px",B.style.borderRadius="50%",B.style.border=n.gyroscopeThickness+"px solid "+n.buttonsColor,l.appendChild(B);var O=document.createElement("div");O.style.boxSizing="inherit",O.style.width=H+"px",O.style.height=F+"px",O.style.borderRadius="50%",O.style.border=n.gyroscopeThickness+"px solid "+n.buttonsColor,O.style.position="absolute",O.style.top="50%",O.style.left="50%",O.style.marginTop=-(F/2+n.gyroscopeThickness)+"px",O.style.marginLeft=-(H/2+n.gyroscopeThickness)+"px",l.appendChild(O);var A=document.createElement("div");A.style.boxSizing="inherit",A.style.width=F+"px",A.style.height=H+"px",A.style.borderRadius="50%",A.style.border=n.gyroscopeThickness+"px solid "+n.buttonsColor,A.style.position="absolute",A.style.top="50%",A.style.left="50%",A.style.marginTop=-(H/2+n.gyroscopeThickness)+"px",A.style.marginLeft=-(F/2+n.gyroscopeThickness)+"px",l.appendChild(A),e.addAction("device-orientation",d);break;case"virtual-reality":var L=n.buttonsHeight*n.virtualRealityRatio,D=L/4,X=D/2;l=document.createElement("div"),l.style.cssFloat="right",l.style.position="relative",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=L+"px",l.style.height=n.buttonsHeight+"px",l.style.backgroundColor=n.buttonsBackgroundColor,l.style.cursor="pointer",o(l,"click",function(){e.toggleStereo()});var W=document.createElement("div");W.style.boxSizing="inherit",W.style.width=L+"px",W.style.height=n.buttonsHeight+"px",W.style.borderRadius=n.virtualRealityBorderRadius+"px",W.style.backgroundColor=n.buttonsColor,l.appendChild(W);var N=document.createElement("div");N.style.boxSizing="inherit",N.style.width=D+"px",N.style.height=D+"px",N.style.position="absolute",N.style.top=X+10+"px",N.style.left=X+10+"px",N.style.borderRadius="50%",N.style.backgroundColor=n.backgroundColor,l.appendChild(N);var $=document.createElement("div");$.style.boxSizing="inherit",$.style.width=D+"px",$.style.height=D+"px",$.style.position="absolute",$.style.top=X+10+"px",$.style.right=X+10+"px",$.style.borderRadius="50%",$.style.backgroundColor=n.backgroundColor,l.appendChild($);var q=document.createElement("div");q.style.boxSizing="inherit",q.style.width=D+"px",q.style.height=n.buttonsHeight/2+"px",q.style.position="absolute",q.style.left="50%",q.style.bottom="10px",q.style.marginLeft=-(D/2)+"px",q.style.borderTopLeftRadius="50% 60%",q.style.borderTopRightRadius="50% 60%",q.style.backgroundColor=n.backgroundColor,l.appendChild(q),e.addAction("stereo-effect",d)}};this.getButton=function(){return l};var r,a,s,l,d=function(e){l.style.backgroundColor=e?n.activeButtonsBackgroundColor:n.buttonsBackgroundColor},c=function(e){s.style.left=e/100*n.zoomRangeWidth-n.zoomRangeDisk/2+"px"},u=function(e){p(parseInt(e.clientX))},h=function(e){var t=e.touches[0];(t.target==r||t.target==a||t.target==s)&&p(parseInt(t.clientX))},p=function(e){f=!0,y(e)},g=function(){f=!1},m=function(e){e.preventDefault(),y(parseInt(e.clientX))},v=function(e){var t=e.touches[0];(t.target==r||t.target==a||t.target==s)&&(e.preventDefault(),y(parseInt(t.clientX)))},y=function(t){if(f){var o=t-a.getBoundingClientRect().left,i=o/n.zoomRangeWidth*100;e.zoom(i)}},f=!1;i()},Sphoords=function(){var e=function(){var e=navigator.userAgent;return/Gecko\/[0-9.]+/.test(e)?"Gecko":/Chrome\/[0-9.]+/.test(e)?"Blink":/AppleWebKit\/[0-9.]+/.test(e)?"WebKit":/Trident\/[0-9.]+/.test(e)?"Trident":/Opera\/[0-9.]+/.test(e)?"Presto":"Gecko"},t=function(e){return e-360*Math.floor(e/360)};this.start=function(){return Sphoords.isDeviceOrientationSupported?(window.addEventListener("deviceorientation",n,!1),i=!0,!0):(console.log("Device Orientation API not supported"),!1)},this.stop=function(){i&&(window.removeEventListener("deviceorientation",n,!1),i=!1)},this.toggle=function(){i?this.stop():this.start()},this.isEventAttached=function(){return i};var n=function(e){c=Sphoords.getScreenOrientation();var n=0,i=0;switch(c){case"portrait-primary":n=e.alpha+e.gamma,i=e.beta-90;break;case"landscape-primary":if(n=e.alpha+e.beta-90,i=-e.gamma-90,Math.abs(e.beta)>90)switch(u){case"Blink":i+=180;break;case"Gecko":default:i=-i}break;case"landscape-secondary":if(n=e.alpha-e.beta+90,i=e.gamma-90,Math.abs(e.beta)>90)switch(u){case"Blink":i+=180;break;case"Gecko":default:i=-i}break;case"portrait-secondary":n=e.alpha-e.gamma,i=180-(e.beta-90),i=270-e.beta}i=t(i),i>=180&&(i-=360),r=t(n),a=Math.max(-90,Math.min(90,i)),s=r*d,l=a*d,o()};this.getCoordinates=function(){return{longitude:s,latitude:l}},this.getCoordinatesInDegrees=function(){return{longitude:r,latitude:a}},this.getScreenOrientation=function(){return c},this.addListener=function(e){h.push(e)};var o=function(){if(h.length)for(var e=0,t=h.length;t>e;++e)h[e]({longitude:s,latitude:l})},i=!1,r=0,a=0,s=0,l=0,d=Math.PI/180,c=Sphoords.getScreenOrientation(),u=e(),h=[]};Sphoords.getScreenOrientation=function(){var e=null;return screen.orientation?e=screen.orientation:screen.mozOrientation?e=screen.mozOrientation:screen.msOrientation&&(e=screen.msOrientation),null!==e&&"object"==typeof e?e.type:e},Sphoords.isDeviceOrientationSupported=!1,function(){function e(t){null!==t&&null!==t.alpha&&(Sphoords.isDeviceOrientationSupported=!0,window.removeEventListener("deviceorientation",e))}window.DeviceOrientationEvent&&null!==Sphoords.getScreenOrientation()&&window.addEventListener("deviceorientation",e)}();